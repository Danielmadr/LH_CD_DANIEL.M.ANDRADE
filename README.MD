# ğŸ¬ Projeto de PrediÃ§Ã£o de Notas IMDB

Este projeto Ã© uma aplicaÃ§Ã£o de Machine Learning para prediÃ§Ã£o de notas IMDB de filmes, desenvolvida com **Streamlit** e incluindo anÃ¡lise exploratÃ³ria de dados (EDA) e trÃªs modelos de ML treinados.

![Tela Principal da AplicaÃ§Ã£o](screenshots/main_page.png)

## ğŸš€ Funcionalidades

### ğŸ“Š AnÃ¡lise ExploratÃ³ria de Dados (EDA)

- VisualizaÃ§Ãµes interativas dos dados
- EstatÃ­sticas descritivas
- AnÃ¡lise de correlaÃ§Ãµes
- DistribuiÃ§Ãµes de variÃ¡veis importantes
- Insights sobre o dataset IMDB

![PÃ¡gina de EDA](screenshots/eda_page.png)

### ğŸ¤– PrediÃ§Ã£o de Notas IMDB

- **3 Modelos disponÃ­veis:**
  - RandomForest
  - XGBoost
  - XGBoost com Optuna (melhor performance)
- **Duas formas de entrada:**
  - FormulÃ¡rio interativo
  - Upload de dados em JSON
- **MÃ©tricas de avaliaÃ§Ã£o** detalhadas para cada modelo
- **Features importantes** de cada modelo
- **InterpretaÃ§Ã£o automÃ¡tica** das prediÃ§Ãµes

![PÃ¡gina de PrediÃ§Ã£o](screenshots/prediction_page.png)

### ğŸ—„ï¸ Banco de Dados SQLite

- Armazenamento local dos dados processados
- Scripts para inicializaÃ§Ã£o e populaÃ§Ã£o do banco
- Consultas otimizadas para anÃ¡lise

## ğŸ“ˆ Performance dos Modelos

### ğŸ“ˆ ComparaÃ§Ã£o de Modelos
```mermaid
  pie showData
    title RMSE (quanto menor, melhor)
    "RandomForest (0.1937)" : 0.1937
    "XGBoost (0.1802)" : 0.1802
    "XGBoost Optuna (0.0883)" : 0.0883
```
```mermaid
  pie showData
    title MAE (quanto menor, melhor)
    "RandomForest (0.1534)" : 0.1534
    "XGBoost (0.1453)" : 0.1453
    "XGBoost Optuna (0.0697)" : 0.0697
```
```mermaid
  pie showData
    title RÂ² (quanto maior, melhor)
    "RandomForest (0.5536)" : 0.5536
    "XGBoost (0.6136)" : 0.6136
    "XGBoost Optuna (0.9073)" : 0.9073
```

## ğŸ› ï¸ InstalaÃ§Ã£o e ExecuÃ§Ã£o

### PrÃ©-requisitos

- Python 3.8+
- pip
- Verifique `requirements.txt`

### ConfiguraÃ§Ã£o do Ambiente

1. **Clone o repositÃ³rio:**

```bash
git clone https://github.com/Danielmadr/LH_CD_DANIEL.M.ANDRADE
cd LH_CD_DANIEL.M.ANDRADE
```

2. **Crie um ambiente virtual:**

```bash
python -m venv .venv
```

3. **Ative o ambiente virtual:**

- Windows: `.venv\Scripts\activate`
- Linux/Mac: `source .venv/bin/activate`

4. **Instale as dependÃªncias:**

```bash
pip install -r requirements.txt
```

### Executando a AplicaÃ§Ã£o

```bash
streamlit run app/main.py
```

A aplicaÃ§Ã£o estarÃ¡ disponÃ­vel em: `http://localhost:8501`

### Inicializando o Banco de Dados (Opcional)

Se desejar recriar o banco de dados:

```bash
python scripts/init_db.py --csv data/raw/desafio_indicium_imdb.csv --db data/production.db
```

## ğŸ“ Estrutura do Projeto

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                 # AplicaÃ§Ã£o principal Streamlit
â”‚   â”œâ”€â”€ EDA_Analysis.py     # PÃ¡gina de anÃ¡lise exploratÃ³ria
â”‚   â””â”€â”€ Prediction.py       # PÃ¡gina de prediÃ§Ã£o
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ production.db           # Banco de dados SQLite
â”‚   â””â”€â”€ raw/
â”‚       â””â”€â”€ desafio_indicium_imdb.csv  # Dataset original
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ RelatÃ³rio de anÃ¡lises estatÃ­sticas e EDA # RelatÃ³rio EDA
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ rf_model_v1.pkl           # Modelo RandomForest treinado
â”‚   â”œâ”€â”€ xgb_model_v1.pkl          # Modelo XGBoost treinado
â”‚   â””â”€â”€ xgb_optuna_model_v1.pkl   # Modelo XGBoost otimizado
|â”€â”€ screenshots/            # Screenshots da aplicaÃ§Ã£o
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ train_rf.py            # Script treinamento RandomForest
â”‚   â”œâ”€â”€ train_xgb.py           # Script treinamento XGBoost
â”‚   â”œâ”€â”€ train_xgb_optuna.py    # Script treinamento XGBoost + Optuna
â”‚   â”œâ”€â”€ optuna_tuner.py        # OtimizaÃ§Ã£o de hiperparÃ¢metros
â”‚   â”œâ”€â”€ evaluate_models.py     # AvaliaÃ§Ã£o e comparaÃ§Ã£o de modelos
â”‚   â”œâ”€â”€ predict.py             # Script de prediÃ§Ã£o standalone
â”‚   â”œâ”€â”€ preprocess.py          # PrÃ©-processamento bÃ¡sico
â”‚   â”œâ”€â”€ preprocessing.py       # Feature engineering avanÃ§ado
â”‚   â”œâ”€â”€ init_db.py             # InicializaÃ§Ã£o do banco SQLite
â”‚   â””â”€â”€ utils.py               # FunÃ§Ãµes utilitÃ¡rias
|â”€â”€ config.py                  # ConfiguraÃ§oes globais        
â”œâ”€â”€ test_model.ipynb          # Notebook de experimentaÃ§Ã£o
â”œâ”€â”€ requirements              # Bibliotecas requisitos do projeto
â””â”€â”€ README.MD                 # Este arquivo
```

## ğŸ¯ Como Usar a PrediÃ§Ã£o

![FormulÃ¡rio de PrediÃ§Ã£o](screenshots/prediction_form.png)

### Via FormulÃ¡rio

1. Acesse a pÃ¡gina "PrediÃ§Ã£o de Notas"
2. Selecione o modelo desejado
3. Preencha os campos do formulÃ¡rio:
   - **TÃ­tulo do Filme**
   - **Ano de LanÃ§amento**
   - **CertificaÃ§Ã£o** (G, PG, PG-13, R, etc.)
   - **DuraÃ§Ã£o** (em minutos)
   - **GÃªnero** (ex: Drama, Action,Adventure)
   - **Meta Score** (0-100)
   - **NÃºmero de Votos**
   - **Diretor e Atores**
   - **Sinopse**
4. Clique em "Prever Nota IMDB"

![Resultado da PrediÃ§Ã£o](screenshots/prediction_result.png)

### Via JSON

1. Acesse a aba "JSON"
2. Use o exemplo fornecido ou cole seu prÃ³prio JSON
3. Clique em "Prever via JSON"

![PrediÃ§Ã£o via JSON](screenshots/json_prediction.png)

**Exemplo de JSON:**

```json
{
  "Series_Title": "The Shawshank Redemption",
  "Released_Year": 1994,
  "Certificate": "A",
  "Runtime": "142 min",
  "Genre": "Drama",
  "Overview": "Two imprisoned men bond over a number of years.",
  "Meta_score": 80.0,
  "Director": "Frank Darabont",
  "Star1": "Tim Robbins",
  "Star2": "Morgan Freeman",
  "Star3": "Bob Gunton",
  "Star4": "William Sadler",
  "No_of_Votes": 2343110,
  "Gross": "28,341,469"
}
```

## ğŸ“Š InterpretaÃ§Ã£o dos Resultados

- **8.0+ :** ğŸŒŸ Excelente! Potencial clÃ¡ssico
- **7.0-7.9:** ğŸ‘ Muito bom! Vale a pena assistir
- **6.0-6.9:** ğŸ‘Œ Bom filme, mas pode nÃ£o agradar a todos
- **< 6.0:** ğŸ‘ Nota baixa, possÃ­veis problemas de qualidade


## ğŸ› ï¸ Pipeline de Machine Learning

### 1. PrÃ©-processamento

- Limpeza de dados ausentes
- NormalizaÃ§Ã£o de formatos
- Tratamento de outliers

### 2. Feature Engineering

- CriaÃ§Ã£o de features derivadas (Movie_Age, Is_Classic, etc.)
- TransformaÃ§Ãµes logarÃ­tmicas
- Encoding de variÃ¡veis categÃ³ricas
- Features de frequÃªncia para atores/diretores

### 3. Treinamento de Modelos

- **RandomForest:** Baseline robusto
- **XGBoost:** Modelo de gradient boosting
- **XGBoost + Optuna:** OtimizaÃ§Ã£o automÃ¡tica de hiperparÃ¢metros

### 4. AvaliaÃ§Ã£o

- ValidaÃ§Ã£o cruzada
- MÃ©tricas: RMSE, MAE, RÂ²
- AnÃ¡lise de feature importance

## ğŸ§ª Experimentos e Notebooks

O projeto inclui notebooks Jupyter para experimentaÃ§Ã£o:

- `test_model.ipynb`: Experimentos com diferentes modelos e configuraÃ§Ãµes
- AnÃ¡lise exploratÃ³ria detalhada
- Testes de diferentes estratÃ©gias de feature engineering

## ğŸ“Š Scripts Standalone

### Treinamento de Modelos

```bash
# Treinar RandomForest
python scripts/train_rf.py

# Treinar XGBoost
python scripts/train_xgb.py

# Treinar XGBoost com Optuna
python scripts/train_xgb_optuna.py
```

### AvaliaÃ§Ã£o de Modelos

```bash
python scripts/evaluate_models.py
```

### PrediÃ§Ã£o via CLI

```bash
python scripts/predict.py models/xgb_optuna_model.pkl
```

## ğŸ—„ï¸ Banco de Dados

O projeto utiliza SQLite para armazenamento:

- **Tabela:** `movies`
- **LocalizaÃ§Ã£o:** `data/production.db`
- **Estrutura:** Dados processados e prontos para ML

## ğŸ“‹ DependÃªncias Completas

```
pandas==2.3.2
numpy==2.3.2
scikit-learn==1.7.1
xgboost==3.0.5
optuna==4.5.0
streamlit==1.49.1
plotly==6.3.0
matplotlib==3.10.6
wordcloud==1.9.4
SQLAlchemy==2.0.43
```

## ğŸ¤ ContribuiÃ§Ã£o

Este projeto foi desenvolvido como parte de um desafio da Lighthouse de Data Science. SugestÃµes e melhorias sÃ£o bem-vindas!


## ğŸ“ˆ PrÃ³ximos Passos

- [ ] Implementar mais modelos (CatBoost, LightGBM)
- [ ] Adicionar explicabilidade com SHAP
- [ ] Monitoramento de drift de dados

## ğŸ† Resultados AlcanÃ§ados

- âœ… **RÂ² = 0.9073** com XGBoost + Optuna
- âœ… **Pipeline completo** de ML
- âœ… **DocumentaÃ§Ã£o abrangente**
- âœ… **CÃ³digo modular** e reutilizÃ¡vel

## ğŸ“„ LicenÃ§a

Este projeto Ã© de uso educacional e demonstrativo.

---

**â­ Se este projeto foi Ãºtil para vocÃª, nÃ£o esqueÃ§a de dar uma estrela!**
